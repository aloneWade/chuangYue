<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.cy.asset.task.dao.CaseManageDao" >

    <select id="queryCase" parameterType="com.cy.asset.task.bean.CaseQueryBean" resultType="com.cy.asset.task.bean.CaseResultBean">
        select
            b.batch_code, c.appoint_case_date, c.expect_back_case_date,
            c.case_serial_number, cus.party_no, b.client, b.product_name,
            cus.customer_name, cus.provinces, c.overdue_days, c.appoint_case_amount,
            c.after_update_amount, c.current_handler
        from cy_case c
        join cy_customer cus on c.party_no = cus.party_no
        join cy_case_batch b on c.batch_code = b.batch_code
        <where>
            <if test="positionNo == 'seats'">
                and c.current_handler = #{um,jdbcType=VARCHAR}
            </if>
            <if test="positionNo == 'director'">
                and c.case_source = #{deptNo,jdbcType=VARCHAR}
            </if>
            <if test="customerName != '' or customerName != null">
                and cus.customer_name like "%"#{customerName,jdbcType=VARCHAR}"%"
            </if>
            <if test="partyNo != '' or partyNo != null">
                and cus.party_no = #{partyNo,jdbcType=VARCHAR}
            </if>
            <if test="provinces != '' or provinces != null">
                and cus.provinces = #{provinces,jdbcType=VARCHAR}
            </if>
            <if test="phoneNo != '' or phoneNo != null">
                and cus.phone_no = #{phoneNo,jdbcType=VARCHAR}
            </if>
            <if test="cardId != '' or cardId != null">
                and cus.card_id = #{cardId,jdbcType=VARCHAR}
            </if>
            <if test="productName != '' or productName != null">
                and b.product_name = #{productName,jdbcType=VARCHAR}
            </if>
            <if test="collectionPhase != '' or collectionPhase != null">
                and c.collection_phase = #{collectionPhase,jdbcType=VARCHAR}
            </if>
            <if test="teamLeaderUm != '' or teamLeaderUm != null">
                and b.dept_director = #{teamLeaderUm,jdbcType=VARCHAR}
            </if>
            <if test="um != '' or um != null">
                and b.empno = #{um,jdbcType=VARCHAR}
            </if>
            <if test="statementDate != '' or statementDate != null">
                and c.statement_date = #{statementDate,jdbcType=VARCHAR}
            </if>
            <if test="collectStatus != '' or collectStatus != null">
                and c.collect_status = #{collectStatus,jdbcType=VARCHAR}
            </if>
            <if test="colorStatus != '' or colorStatus != null">
                and c.color_status = #{colorStatus,jdbcType=VARCHAR}
            </if>
            <if test="caseStatus != '' or caseStatus != null">
                and c.case_status = #{collectStatus,jdbcType=VARCHAR}
            </if>
        </where>
        order by c.update_date desc
    </select>

</mapper>